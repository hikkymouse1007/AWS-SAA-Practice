# DynamoDB
- フルマネージド、3つのAZでのレプリケーションによる高可用性
- NoSQLデータベース - リレーショナルデータベースではない
- 大規模なワークロード、分散データベースへのスケールアップ
- 毎秒数百万回のリクエスト、数兆行、100TBのストレージ - 高速で一貫したパフォーマンス（検索時のレイテンシが低い）。
- セキュリティ、認証、管理のためのIAMとの統合 - DynamoDBストリームを使用したイベント駆動型プログラミングを可能にする
- 低コストと自動スケーリング機能

## Basics
- DynamoDBはテーブルで構成される
- 各テーブルは主キーを持つ（作成時に決定）
 - 各テーブルは無限の数の項目（＝行）を持つことが可能
- 各項目には属性がある（後から追加可能 - nullable） 
- アイテムの最大サイズは400KB
- サポートされているデータ型は以下
    - スカラー型:String, Number, Binary, Boolean, Null
    - ドキュメント型:List,Map
    - セットタイプ: Stringセット、Numberセット、Binaryセット

## Provisioned Throughput
- テーブルにはプロビジョニングされたRWキャパシティユニットが必要
- ReadCapacityUnit（RCU）：読み取りのスループット（RCUあたり$0.00013）
    - 1 RCU = 1秒間に4 KBの一貫性のある読み取りを1回実施
    - 1 RCU = 2 最終的には毎秒4 KBの一貫した読み取り
- 書き込み容量単位（WCU）：書き込みのスループット（WCUあたり$0.00065） 
    - 1WCU=1writeof1KBpersecond
- 需要に応じてスループットの自動スケーリングを設定するオプション
- バーストクレジットを使用して一時的にスループット超過可能
- バーストクレジットが空になると"ProvisionedThroughputException"が発生。
- その場合、指数関数的なback-offリトライ推奨

## DAX
- DAX = DynamoDBアクセラレータ
- DynamoDBのためのシームレスなキャッシュ、アプリケーションの再書き込みが不要
- 書き込みはDAXを経由してDynamoDBへ
- キャッシュされたリードとクエリのマイクロ秒のレイテンシ
- ホットキーの問題を解決する（読み取り過多)
- デフォルトではキャッシュのTTLは5分
- クラスタ内の最大10ノード
- マルチAZ（本番環境には最低3ノードを推奨)
- セキュア（KMS,VPC,IAM,CloudTrailでの安静時の暗号化...)

## DynamoDB Stream
- DynamoDBでの変更（作成、更新、削除）をDynamoDBストリームへ送信
- このストリームをAWS Lambdaで読み込むことで
    - リアルタイムでの変更への反応(新規ユーザーへの歓迎メール)
    - 分析
    - 派生テーブル/ビューの作成
    - ElasticSearchに挿入
- Streams を使用してクロスリージョンレプリケーションを実装可能
- ストリームは24時間のデータ保持が可能

## New Features from 2018
- トランザクション（2018年11月からの新規）
    - All-or-nothingタイプの操作
    - 複数テーブルにまたがる協調型の挿入、更新、削除 
    - 最大10個のユニークな項目、または最大4MBのデータを含む

- オンデマンド（2018年11月より新発売
    - 容量計画の必要なし（WCU / RCU - 自動的にスケールアップ
    - 提供容量の2.5倍（ケア付き利用
    - スパイクが予測できない場合や、アプリケーションのスループットが非常に低い場合に役立つ

## Security + Other Features
- Security
    - インターネットがなくてもDynamoDBにアクセスできるVPCエンドポイント
    - IAMで完全に制御されたアクセス
    - KMSを使用した安静時の暗号化
    - SSL/TLSを使用した暗号化
- バックアップとリストア機能が利用可能 
    - RDSのようなポイント・イン・タイム・リストア
    - パフォーマンスへの影響なし
- グローバルテーブル
    - マルチリージョン、完全複製、ハイパフォーマンス
- Amazon DMSを使ってDynamoDBへの移行が可能（Mongo、Oracle、MySQL、S3などから)
- 開発目的でローカルのDynamoDBをパソコン上で起動可能

## Other Features
- GlobalTables(クロスリージョンレプリケーション)
    - Active-Activeレプリケーション、多数のリージョン
    - DynamoDBストリームを有効にする必要がある
    - 低レイテンシー、DR(DisasterRecovery)目的に便利

- Capacity planning
    - Planned Capacity: WCU と RCU を提供し、自動スケーリングを可能にすることができます。
    - On-demand Capacity：無制限のWCUとRCUを取得、スロットルなし、高価